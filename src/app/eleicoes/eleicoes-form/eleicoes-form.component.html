<h2>Abertura de Nova Eleição</h2>
<p>
  Para abrir uma nova eleição, basta seguir os passos abaixo.
</p>

<app-panel>


  <app-wizard [steps]="steps" (changeStep)="changeStep($event)" [validNext]="validNext">
    <div [ngSwitch]="currentStepIndex">

      <div *ngSwitchCase="1">
        <form [formGroup]="formGestao">
          <div class="row">
            <div class="col-lg-4 col-md-6 col-sm-12">
              Qual é o ano de gestão a que se refere essa eleição?
              <input type="number" formControlName="gestao" class="form-control">
            </div>
          </div>
          <br>
          <div class="row">
            <div class="col-lg-4 col-md-6 col-sm-12">
              Qual é o tempo de duração dessa gestão? (em anos)
              <input type="number" formControlName="duracao" class="form-control">
            </div>
          </div>
        </form>
        <br>
        <p *ngIf="exibeGestao">Gestão <strong>{{ formGestao.get('gestao').value }} -
            {{ formGestao.get('gestao').value + formGestao.get('duracao').value - 1}}</strong></p>
      </div>

      <div *ngSwitchCase="2">
        <div class="row">
          <div class="col-md-12" *ngIf="empresas.length; else novaEmpresa">
            Observamos que você já possui {{ empresas.length }} empresas cadastradas. Escolha uma delas para iniciar a
            nova
            eleição, ou
            cadastre uma nova empresa.

            <form [formGroup]="formListaEmpresa">
              <div class="row">
                <div class="col-lg-4 col-md-6 col-sm-12">
                  <select class="form-control m-t-sm" name="lista-empresa" id="lista-empresa" formControlName="empresa">
                    <option value="">(Selecione a empresa)</option>
                    <option [value]="emp.id" *ngFor="let emp of empresas">{{ emp.razaoSocial }}</option>
                  </select>
                </div>
              </div>
            </form>

            <button class="btn btn-primary m-t-md"><i class="fa fa-plus"></i> Nova Empresa</button>
          </div>
          <ng-template #novaEmpresa>
            <div class="col-md-12">
              <p>Para iniciar uma eleição, você precisa primeiro cadastrar a empresa.</p>
              <button class="btn btn-primary"><i class="fa fa-plus"></i> Nova Empresa</button>
            </div>
          </ng-template>
        </div>
      </div>

      <div *ngSwitchCase="3">
        <div class="row">
          <div class="col-md-12" *ngIf="estabelecimentos.length; else novoEstabelecimento">
            <div *ngIf="estabelecimentos.length > 1; else estabelecimentoUnico">
              A empresa selecionada possui {{ estabelecimentos.length }} estabelecimentos.
              Selecione um deles ou cadastre um novo estabelecimento.
            </div>
            <ng-template #estabelecimentoUnico>
              A empresa selecionada já possui 1 estabelecimento cadastrado. Já selecionamos ele para você.<br>
              Se precisar cadastrar um novo estabelecimento, basta clicar no botão abaixo.
            </ng-template>
            <form [formGroup]="formListaEstabelecimentos">
              <div class="row">
                <div class="col-lg-6 col-md-8 col-sm-12">
                  <select class="form-control m-t-sm" name="lista-estabelecimento" id="lista-estabelecimento"
                    formControlName="estabelecimento">
                    <option value="">(Selecione o estabelecimento)</option>
                    <option [value]="est.id" *ngFor="let est of estabelecimentos">{{ est.enderecoStr() }}</option>
                  </select>
                </div>
              </div>
            </form>
            <button class="btn btn-primary m-t-md"><i class="fa fa-plus"></i> Novo Estabelecimento</button>
          </div>
          <ng-template #novoEstabelecimento>
            <div class="col-md-12">
              <p>Agora que você definiu a empresa, precisa cadastrar o estabelecimento que passará pelo processo de
                eleição da
                CIPA. Clique no botão abaixo para realizar o cadastro</p>
              <button class="btn btn-primary"><i class="fa fa-plus"></i> Novo Estabelecimento</button>
            </div>
          </ng-template>
        </div>
      </div>

      <div *ngSwitchCase="4">

        <div id="vertical-timeline" class="vertical-container light-timeline no-margins">
          <div etapa-cronograma class="vertical-timeline-block" *ngFor="let etapa of cronograma" [etapa]="etapa"
            layout="Cadastro"></div>
        </div>

        <button class="btn btn-success m-t-md">Abrir Eleição!</button>
      </div>

    </div>
  </app-wizard>

</app-panel>
